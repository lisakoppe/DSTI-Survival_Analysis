---
title: "Lung Cancer Prognosis"
author: "Lisa KOPPE, Khwansiri NINPAN, Princy PAPPACHAN"
date: "4/23/2020"
output: word_document
---

Paper:
[Integrated evaluation of clinical, pathological and radiological prognostic factors in squamous cell carcinoma of the lung](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6777828/)

# Import the necessary packages:

```{r}
library(tidyverse)
library(survival)
library(survminer)
library(asaur)
```

# Data preparation: load the lung cancer dataset and check data types

```{r}
lungSCC_raw <- read_csv("../LungCancer.csv",
                         col_types=cols(Sex='c',
                                       Age='d',
                                       Location='d',
                                       Obst_pn_or_plugging='d',
                                       Necrosis='d',
                                       Underlying_lung='d',
                                       Effusion='d',
                                       LN_ratio='d',
                                       cT='d',
                                       cN='d',
                                       cM='d',
                                       pT='d',
                                       pN='d',
                                       pM='d',
                                       Smoking_state='d',  
                                       FEV1_FVC='d',
                                       CEA='d',
                                       op_type='d',
                                       death='d',
                                       meta='d',
                                       OS = "d",
                                       .default = 'c'))
```

# Explore the dataset:
    - For classification data, use "table"
    - For numerical data: use "table" + "summary"
      (Summary to define basic descriptive statistic, Table to check null value)

```{r}
dim(lungSCC_raw)  # Check total patients + columns


# Radiologic features
table(lungSCC_raw$Location, useNA="always")
table(lungSCC_raw$Obst_pn_or_plugging, useNA="always")
table(lungSCC_raw$Necrosis, useNA="always")
table(lungSCC_raw$Underlying_lung, useNA="always")
table(lungSCC_raw$Effusion, useNA="always")

# Clinicopathologic features
table(lungSCC_raw$Sex, useNA="always")
table(lungSCC_raw$Age, useNA="always")
summary(lungSCC_raw$Age)
table(lungSCC_raw$LN_ratio, useNA="always")
summary(lungSCC_raw$LN_ratio)
table(lungSCC_raw$cT, useNA="always")
table(lungSCC_raw$cN, useNA="always")
table(lungSCC_raw$cM, useNA="always")
table(lungSCC_raw$pT, useNA="always")
table(lungSCC_raw$pN, useNA="always")
table(lungSCC_raw$pM, useNA="always")
table(lungSCC_raw$Smoking_state, useNA="always")
table(lungSCC_raw$FEV1_FVC, useNA="always")
summary(lungSCC_raw$FEV1_FVC)
table(lungSCC_raw$CEA)
summary(lungSCC_raw$CEA)
table(lungSCC_raw$op_type, useNA="always")
table(lungSCC_raw$death, useNA="always")
table(lungSCC_raw$meta, useNA="always")
table(lungSCC_raw$OS, useNA="always")
summary(lungSCC_raw$OS)
```


Redefine the meaning of each label to make it easier for interpretation


```{r}

lungSCC <- mutate(lungSCC_raw,
                  Location=ifelse(Location==0, "Peripheral","Central"),

                  Necrosis=ifelse(Necrosis==0, "NoRemark",
                                  ifelse(Necrosis==1, "Necrosis", "Cavitation")),

                  Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
                                         ifelse(Underlying_lung==1, "Emphysema", "ILA")),

                  Effusion=factor(Effusion, levels=c("0", "1"), labels=c("Absent", "Present")),

                  AG=ifelse((Age<60), "LT60", "OV60"),

                  AG = factor(AG),

                  OP = factor(op_type,labels = c("lobectomy","pneumonectomy","segmentectomy","LN biopsy","No OP")),

                  Smoking_state = factor(Smoking_state,labels = c("unknown","current-smoker","ex- smoker", "non- smoker")),

                  cT = factor(cT, levels = c("1", "2", "3", "4"), labels = c("cT1", "cT2", "cT3", "cT4")),

                  cN = factor(cN, levels = c("1", "2", "3", "4"), labels = c("cN0", "cN1", "cN2", "cN3")),

                  cM = factor(cM, levels = c("1", "3"), labels = c("cM0", "cM1b")),

                  pT = factor(pT, levels = c("1", "2", "3", "4"), labels = c("pT1", "pT2", "pT3", "pT4")),

                  pN = factor(pN, levels = c("1", "2", "3", "4"), labels = c("pN0", "pN1", "pN2", "pN3")),

                  pM = factor(pM, levels = c("1", "3"), labels = c("pM0", "pM1b")))
```

# Features description

1. Location
   = Tumor location
   (0 = Peripheral SCC, 1 = Central SCC)

2. death
   (0 = Alive, 1 = Dead)

3. OS
   = Overall Survival in months: interval between the date of diagnosis and date of death (by any cause)

## Radiologic features:

4. Obst_pn_or_plugging
   = Presence of obstructive pneumonitis/atelectais
   (0 = Absent, 1 = Present)

5. Necrosis
   (0 = No Remark, 1 = Necrosis, 2 = Cavitation)

6. Underlying_lung
   = Underlying lung disease
   (0 = No Remark, 1 = Emphysema, 2 = Interstitial lung abnormality)

7. Effusion
   (0 = Absent, 1 = Present)

## Clinicopathologic features:

8. Sex
   = Gender of the patient
   (F=Female, M=Male)

9. AG
   = Age at diagnosis
   (LT60 = Less than 60 years old, OV60 = Over 60 years old)

10. LN_ratio
    = Lymph node ratio: Number of nodes with positive tumor cells divided by the number of all resected nodes

11. cT
    = Size of original tumor in central lung SCC patients
    (1 = T1, 2 = T2, 3 = T3, 4 = T4)

12. cN
    = Nearby lymph nodes involved in central lung SCC patients
    (1 = N0, 2 = N1, 3 = N2, 4 = N3)

13. cM
    = Distant metastasis (spread of cancer from one part of the body to another) in central lung SCC patients
    (1 = M0, 2 = M1a, 3 = M1b, 4 = M1ab, 5 = Mx)

14. pT
    = Size of original tumor in peripheral lung SCC patients
    (1 = T1, 2 = T2, 3 = T3, 4 = T4)

15. pN
    = Nearby lymph nodes involved in peripheral lung SCC patients
    (1 = N0, 2 = N1, 3 = N2, 4 = N3)

16. pM
    = Distant metastasis (spread of cancer from one part of the body to another) in peripheral lung SCC patients
    (1 = M0, 2 = M1a, 3 = M1b, 4 = M1ab, 5 = Mx)

17. Smoking_state
    = Current smoking state of the patient
    (current-smoker, ex-smoker, non-smoker, unknown)

18. FEV1_FVC
    = Pulmonary function test in %: forced expiratory volume in a second / forced vital capacity

19. CEA
    = Serum carcinoembryonic antigen level in ng/ml (tumor marker)

20. OP
    = Type of operation the person has undergone
    (lobectomy, pneumonectomy, segmentectomy, LN biopsy, no Op)

21. meta
    = Metastasis observed
    (0=Absent, 1=Present)
    
______________________________________________________________________________________

*# Part2: Test relationship between radiologic/clinicopathologic features and survival time (OS)*

1. Question asked

2. Methods used
- Cox Proportional Hazards Model
- Confidence intervals
- Kaplan-Meier estimator
- Logrank test

3. Results (+ include tables and code)

+ Visualizing the estimated distribution of survival times



*## Part2.A: Cox Proportional Hazards Regression Model fit*

>> DESCRIBE THE METHODS TO USE

Methods used: Cox Proportional Hazards Model

we use R coxph():

The Cox regression results can be interpreted as follow:

*1. Statistical significance:*
The Wald statistic value z, corresponds to the ratio of each regression coefficient to its standard error (z = coef/se(coef)). The wald statistic evaluates, whether the beta (Î²) coefficient of a given variable is statistically significantly different from 0. 

*2. The regression coefficient:*
The second feature to note in the Cox model results is the the sign of the regression coefficients (coef). A positive sign means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The R summary for the Cox model gives the hazard ratio (HR) for the second group relative to the first group.

*3. Hazard ratios (HR):*
The exponentiated coefficient (exp(coef)) gives the effect size of covariates.

*4. Confidence intervals of the hazard ratios:*
The summary output also gives upper and lower 95% confidence intervals for the hazard ratio (exp(coef)).

*5. Global statistical significance of the model:*
Finally, the output gives p-values for three alternative tests for overall significance of the model: The likelihood-ratio test, Wald test, and score logrank statistics. These three methods are asymptotically equivalent. For large enough N, they will give similar results. For small N, they may differ somewhat. The Likelihood ratio test has better behavior for small sample sizes, so it is generally preferred.

Thanks to these results, we can decide to reject or keep covariates for the upcoming study based on their statistical significance.


*## Part2.A.1: Cox Proportional Hazards Regression Model fit including all the studied features*

>> INTRODUCE REGRESSION

```{r}
lungSCC_fullmodel <- coxph(Surv(OS, death) ~ Location + Obst_pn_or_plugging + Necrosis + Underlying_lung + Effusion + Sex + AG + LN_ratio + cT+ cN + cM + pT+ pN+ pM + Smoking_state + FEV1_FVC + CEA + OP + meta, data=lungSCC)

summary(lungSCC_fullmodel)
```

According to the outputed coefficients, the statistically significant features we could consider keeping for the next steps of the study are the following (ranked by order of significancy):
- meta: p-value=0.0000004
- Underlying_lungILA: p-value=0.0002
- pM1b: p-value=0.0003
- Smoking_state, non-smoker: p-value=0.0009
- cT3: p-value=0.002
- pN2: p-value=0.003
- AG OV60: p-value=0.004
- Underlying_lung, No Remark: p-value=0.008

Let's save the table of results in a csv file:
```{r}
broom::tidy(lungSCC_fullmodel) %>%
   write_csv("coefficients_table.csv")
```

We will now compute the Cox Proportional Hazards Regression Model fit for each individual variable and their corresponding confidence intervals (CI).
This step will help us select the significant covariate for the upcoming study.


*## Part2.A.2: Cox Proportional Hazards Regression Model fit - Univariate Analysis*

We here split the analysis into two groups of features:
- Radiologic features
- Clinicopathologic features

>> DO NOT FORGET TO PUT COX FOR LOCATION SOMEWHERE

*### Part2.A.2.a:Relationship between radiologic features and survival time (OS)*

Features to be analyzed in this part:

1. Obst_pn_or_plugging vs OS: patients with or without obstructive pneumonitis/atelectais
2. Necrosis vs OS: patients with or without cell necrosis or cavitation observed
3. Underlying_lung vs OS: the type of underlying lung disease observed
4. Effusion vs OS: patient with or without observed lung effusion

>> CAREFUL WITH "CAVITATION" SPELLING EVERYWHERE IN REPORT

1. Obst_pn_or_plugging vs OS: patients with or without obstructive pneumonitis/atelectais:
```{r}
fit_Obst_pn_or_plugging <- coxph(Surv(OS, death) ~ Obst_pn_or_plugging, data=lungSCC)
summary(fit_Obst_pn_or_plugging)
```

2. Necrosis vs OS: patients with or without cell necrosis or cavitation observed:
```{r}
fit_necrosis <- coxph(Surv(OS, death) ~ Necrosis, data=lungSCC)
summary(fit_necrosis)
```

3. Underlying_lung vs OS: the type of underlying lung disease observed:
```{r}
fit_UndLung <- coxph(Surv(OS, death) ~ Underlying_lung, data=lungSCC)
summary(fit_UndLung)
```

4. Effusion vs OS: patient with or without observed lung effusion:
```{r}
fit_effusion <- coxph(Surv(OS, death) ~ Effusion, data=lungSCC)
summary(fit_effusion)
```

The p-values of Obst_pn_or_plugging (0.1), Necrosis (0.05) and effusion (0.9) are too high to consider these features as statistically significant. We then reject the use of these three covariates for the upcoming study.

However, with a very low p-value of *1.95e-05* and a positive coefficient of *1.21*, we can assume that there is a highly significant positive relationship between survival time (OS) and Interstitial lung abnormalities (ILA). With a value of *1.21*, the sign of the regression coefficient for ILA is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for ILA=*1.21* indicates that patients with ILA have higher risk of death (lower survival rates) than patients with emphysema. The exponentiated coefficient (exp(coef)=exp(1.21)=*3.35*) gives the effect size of covariates. Here, a patient with ILA increases the hazard by a factor of *3.35*, or *235%*. Having ILA is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.92*, upper 95% bound=*5.83* for ILA.

*To conclude, we decide to select Underlying_lung as a significant covariate for the upcoming study.*


*### Part2.A.2.b:Relationship between clinicopathologic features and survival time (OS)*

Features to be analyzed in this part:

1. Sex vs OS: gender of the patient
2. AG vs OS: age of the patient at diagnosis
3. LN_ratio vs OS: lymph node ratio
4. cT vs OS: central lung SCC size of tumor
5. cN vs OS: when nearby lymph nodes are involved
6. cM vs OS: when distant metastasis are involved
7. pT vs OS: peripheral lung SCC size of tumor
8. pN vs OS: when nearby lymph nodes are involved
9. pM vs OS: when distant metastasis are involved
10. Smoking_state vs OS: current smoking state of the patient
11. FEV1_FVC vs OS: pulmonary function test
12. CEA vs OS: serum carcinoembryonic antigen level
13. OP vs OS: the type of operation undergone by the patient
14. meta vs OS: patient with and without observed metastasis after surgery


1. Sex vs OS: gender of the patient:
```{r}
fit_Sex <- coxph(Surv(OS, death) ~ Sex, data=lungSCC)
summary(fit_Sex)
```

2. AG vs OS: age of the patient at diagnosis:
```{r}
fit_Age <- coxph(Surv(OS, death) ~ AG, data=lungSCC)
summary(fit_Age)
```

3. LN_ratio vs OS: lymph node ratio:
```{r}
fit_LNratio <- coxph(Surv(OS, death) ~ LN_ratio, data=lungSCC)
summary(fit_LNratio)
```

4. cT vs OS: central lung SCC size of tumor:
```{r}
fit_cT <- coxph(Surv(OS, death) ~ cT, data=lungSCC)
summary(fit_cT)
```

5. cN vs OS: when nearby lymph nodes are involved:
```{r}
fit_cN <- coxph(Surv(OS, death) ~ cN, data=lungSCC)
summary(fit_cN)
```

6. cM vs OS: when distant metastasis are involved:
```{r}
fit_cM <- coxph(Surv(OS, death) ~ cM, data=lungSCC)
summary(fit_cM)
```

7. pT vs OS: peripheral lung SCC size of tumor:
```{r}
fit_pT <- coxph(Surv(OS, death) ~ pT, data=lungSCC)
summary(fit_pT)
```

8. pN vs OS: when nearby lymph nodes are involved:
```{r}
fit_pN <- coxph(Surv(OS, death) ~ pN, data=lungSCC)
summary(fit_pN)
```

9. pM vs OS: when distant metastasis are involved:
```{r}
fit_pM <- coxph(Surv(OS, death) ~ pM, data=lungSCC)
summary(fit_pM)
```

10. Smoking_state vs OS: current smoking state of the patient:
```{r}
fit_Smoking_state <- coxph(Surv(OS, death) ~ Smoking_state, data=lungSCC)
summary(fit_Smoking_state)
```

11. FEV1_FVC vs OS: pulmonary function test:
```{r}
fit_FEV1FVC <- coxph(Surv(OS, death) ~ FEV1_FVC, data=lungSCC)
summary(fit_FEV1FVC)
```

12. CEA vs OS: serum carcinoembryonic antigen level:
```{r}
fit_CEA <- coxph(Surv(OS, death) ~ CEA, data=lungSCC)
summary(fit_CEA)
```

13. OP vs OS: the type of operation undergone by the patient:
```{r}
fit_op_type <- coxph(Surv(OS, death) ~ OP, data=lungSCC)
summary(fit_op_type)

```

14. meta vs OS: patient with and without observed metastasis after surgery:
```{r}
fit_meta <- coxph(Surv(OS, death) ~ meta, data=lungSCC)
summary(fit_meta)
```

>> FOR OPERATION DO WE HAVE TO USE OP OR OP_TYPE?

The p-values of Sex (0.5), cM (0.7), Smoking_state (0.2), FEV1_FVC (0.1) and CEA (0.6) are too high to consider these features as statistically significant. We then reject the use of these five covariates for the upcoming study.

Also, the repartition of the population in the groups is too unbalanced for the LN_ratio covariate so this feature will also be rejected for the next steps of the study.

However, with a low p-value of *0.001* and a positive coefficient of *0.70*, we can assume that there is a statistically significant positive relationship between survival time (OS) and age over 60. With a value of *0.70*, the sign of the regression coefficient for age over 60 is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for age over 60=*0.70* indicates that patients aged over 60 have higher risk of death (lower survival rates) than younger patients. The exponentiated coefficient (exp(coef)=exp(0.70)=*2.01*) gives the effect size of covariates. Here, a patient older than 60 increases the hazard by a factor of *2.01*, or *101%*. Being older than 60 is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.33*, upper 95% bound=*3.06* for age over 60.

With a low p-value of *2.99e-05* and a positive coefficient of *1.14*, we can assume that there is a statistically significant positive relationship between survival time (OS) and cT3. With a value of *1.14*, the sign of the regression coefficient for cT3 is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for cT3=*1.14* indicates that patients with cT3 have higher risk of death (lower survival rates) than patients with cT1. The exponentiated coefficient (exp(coef)=exp(1.14)=*3.14*) gives the effect size of covariates. Here, a patient with cT3 increases the hazard by a factor of *3.14*, or *214%*. Having cT3 is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.84*, upper 95% bound=*5.38* for cT3.

With a low p-value of *0.0003* and a positive coefficient of *0.77*, we can assume that there is a statistically significant positive relationship between survival time (OS) and cN2. With a value of *0.77*, the sign of the regression coefficient for cN2 is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for cN2=*0.77* indicates that patients with cN2 have higher risk of death (lower survival rates) than patients with cN0. The exponentiated coefficient (exp(coef)=exp(0.77)=*2.16*) gives the effect size of covariates. Here, a patient with cN2 increases the hazard by a factor of *2.16*, or *116%*. Having cN2 is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.42*, upper 95% bound=*3.29* for cN2.

With a low p-value of *0.007* and a positive coefficient of *0.69*, we can assume that there is a statistically significant positive relationship between survival time (OS) and pT3. With a value of *0.69*, the sign of the regression coefficient for pT3 is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for pT3=*0.69* indicates that patients with pT3 have higher risk of death (lower survival rates) than patients with pT1. The exponentiated coefficient (exp(coef)=exp(0.69)=*1.99*) gives the effect size of covariates. Here, a patient with pT3 increases the hazard by a factor of *1.99*, or *99%*. Having pT3 is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.20*, upper 95% bound=*3.30* for pT3.

With a low p-value of *1.51e-05* and a positive coefficient of *0.86*, we can assume that there is a statistically significant positive relationship between survival time (OS) and pN2. With a value of *0.86*, the sign of the regression coefficient for pN2 is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for pN2=*0.86* indicates that patients with pN2 have higher risk of death (lower survival rates) than patients with pN0. The exponentiated coefficient (exp(coef)=exp(0.86)=*2.37*) gives the effect size of covariates. Here, a patient with pN2 increases the hazard by a factor of *2.37*, or *137%*. Having pN2 is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.60*, upper 95% bound=*3.50* for pN2.

With a low p-value of *0.0005* and a positive coefficient of *1.77*, we can assume that there is a statistically significant positive relationship between survival time (OS) and pM1b. With a value of *1.77*, the sign of the regression coefficient for pM1b is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for pM1b=*1.77* indicates that patients with pM1b have higher risk of death (lower survival rates) than patients with pM0. The exponentiated coefficient (exp(coef)=exp(1.77)=*5.85*) gives the effect size of covariates. Here, a patient with pM1b increases the hazard by a factor of *5.85*, or *485%*. Having pM1b is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*2.16*, upper 95% bound=*15.84* for pM1b.

With a low p-value of *2.17e-06* and a positive coefficient of *1.50*, we can assume that there is a statistically significant positive relationship between survival time (OS) and biopsy operation type. With a value of *1.50*, the sign of the regression coefficient for biopsy is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for biopsy=*1.50* indicates that patients who undergo biopsy have higher risk of death (lower survival rates) than patients who undergo lobectomy. The exponentiated coefficient (exp(coef)=exp(1.50)=*4.50*) gives the effect size of covariates. Here, a patient who undergo biopsy increases the hazard by a factor of *4.50*, or *350%*. Biopsy operation type is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*2.41*, upper 95% bound=*8.37* for biopsy.

With a low p-value of *5.22e-08* and a positive coefficient of *0.85*, we can assume that there is a statistically significant positive relationship between survival time (OS) and the observation of metastasis. With a value of *0.85*, the sign of the regression coefficient for observed metastasis is positive which means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. The beta coefficient for observed metastasis=*0.85* indicates that patients with observed metastasis have higher risk of death (lower survival rates) than patients without metastasis. The exponentiated coefficient (exp(coef)=exp(0.85)=*2.33*) gives the effect size of covariates. Here, a patient with observed metastasis increases the hazard by a factor of *2.33*, or *133%*. Observed metastasis is indeed associated with bad prognostic. Moreover, the summary output also gives upper and lower 95% confidence intervals (CI) for the hazard ratio (exp(coef)) as follows: lower 95% bound=*1.72*, upper 95% bound=*3.16* for observed metastasis.

*To conclude, we decide to select AG, cT, cN, pT, pN, pM, OP and meta as a significant covariates for the upcoming study.*


*## Part2.A.3: Cox Proportional Hazards Regression Model fit - Multivariate Analysis*

>> TO DO

*# Part3: Kaplan-Meier estimator with features which have a significant relationship with survival time (OS)*

List of features which have a significant relationship with survival time (OS):

1. Comparison between 2 groups of patients based on underlying lung disease
2. Comparison between 2 groups of patients based on their age
3. Comparison between 2 groups of patients based on central lung SCC size of tumor
4. Comparison between 2 groups of patients based on cN when nearby lymph nodes are involved
5. Comparison between 2 groups of patients based on peripheral lung SCC size of tumor
6. Comparison between 2 groups of patients based on pN when nearby lymph nodes are involved
7. Comparison between 2 groups of patients based on pM when distant metastasis are involved
8. Comparison between 2 groups of patients based on the type of operation undergone by the patient
9. Comparison between 2 groups of patients based on the observation of metastasis after surgery


1. Comparison between 2 groups of patients based on underlying lung disease:
```{r}
fit.KM_under <- survfit(Surv(OS, death) ~ Underlying_lung, data=lungSCC)
fit.KM_under
```

We plot the Kaplan-Meier survival curve:
```{r}
ggsurvplot(fit.KM_under,
           legend = "bottom",
           conf.int = TRUE,
           linetype = "strata",
           legend.title = "Underlying lung disease",
           xlab = "Months",
           ylab = "Survival probability")
```

The logrank test:
```{r}
survdiff(Surv(OS, death) ~ Underlying_lung, data=lungSCC)
```

>> TO DO




