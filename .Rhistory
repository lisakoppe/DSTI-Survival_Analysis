table(lungSCC_raw$CEA, useNA="always")
table(lungSCC_raw$op_type, useNA="always")
table(lungSCC_raw$meta, useNA="always")
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Invisible",
ifelse(Location==1, "Central", "Peripheral")),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")))
with(lungSCC, fisher.test(table(death, Obst_pn_or_plugging)))
with(lungSCC, fisher.test(table(death, meta)))
fit <- glm(death~Location, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, fisher.test(table(death, Effusion)))
with(lungSCC, fisher.test(table(death, Obst_pn_or_plugging)))
with(lungSCC, table(death, meta))
# CAREFUL: NEED TO REVIEW DATA TYPES (ESPECIALLY LOGICAL)
lungSCC_raw <- read_csv("LungCancer.csv",
col_types=cols(Index='c',
Sex='c',
Age='d',
Location='d',
Obst_pn_or_plugging='d',
CT_value_Mean='d',
CT_value_Std_Dev='d',
CT_value_P_major='d',
CT_V_ratio='d',
CT_Kernel='c',
Necrosis='c',
Underlying_lung='c',
Multiplicity='l',
Effusion='l',
Bronchoscopy='c',
Differentiation='c',
pos_LN='c',
total_LN='d',
LN_ratio='d',
cT='c',
cN='c',
cM='c',
pT='c',
pN='c',
pM='c',
Smoking_state='c',
PY='d',
Cessation_time='d',
FVCpercentPRED='d',
FEV1percentPRED='d',
FEV1_FVC='d',
CEA='d',
post_opCTx='l',
post_op_RTx='l',
op_type='c',
death='d',
recur_or_meta='l',
OP_site_recur='l',
meta='c',
meta_site='c',
OS='d',
DFS='d',
.default = 'c'))
table(lungSCC_raw$Location, useNA="always")
table(lungSCC_raw$death, useNA="always")
sum(is.na(lungSCC_raw$death))
# Radiologic features
table(lungSCC_raw$Obst_pn_or_plugging, useNA="always")
table(lungSCC_raw$Necrosis, useNA="always")
table(lungSCC_raw$Underlying_lung, useNA="always")
table(lungSCC_raw$Effusion, useNA="always")
# Clinicopathologic features
table(lungSCC_raw$Sex, useNA="always")
table(lungSCC_raw$Age, useNA="always")
table(lungSCC_raw$LN_ratio, useNA="always")
table(lungSCC_raw$cT, useNA="always")
table(lungSCC_raw$cN, useNA="always")
table(lungSCC_raw$cM, useNA="always")
table(lungSCC_raw$pT, useNA="always")
table(lungSCC_raw$pN, useNA="always")
table(lungSCC_raw$pM, useNA="always")
table(lungSCC_raw$Smoking_state, useNA="always")
table(lungSCC_raw$FEV1_FVC, useNA="always")
table(lungSCC_raw$CEA, useNA="always")
table(lungSCC_raw$op_type, useNA="always")
table(lungSCC_raw$meta, useNA="always")
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Invisible",
ifelse(Location==1, "Central", "Peripheral")),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")))
with(lungSCC, table(death, meta))
# CAREFUL: NEED TO REVIEW DATA TYPES (ESPECIALLY LOGICAL)
lungSCC_raw <- read_csv("LungCancer.csv",
col_types=cols(Index='c',
Sex='c',
Age='d',
Location='d',
Obst_pn_or_plugging='d',
CT_value_Mean='d',
CT_value_Std_Dev='d',
CT_value_P_major='d',
CT_V_ratio='d',
CT_Kernel='c',
Necrosis='c',
Underlying_lung='c',
Multiplicity='l',
Effusion='l',
Bronchoscopy='c',
Differentiation='c',
pos_LN='c',
total_LN='d',
LN_ratio='d',
cT='c',
cN='c',
cM='c',
pT='c',
pN='c',
pM='c',
Smoking_state='c',
PY='d',
Cessation_time='d',
FVCpercentPRED='d',
FEV1percentPRED='d',
FEV1_FVC='d',
CEA='d',
post_opCTx='l',
post_op_RTx='l',
op_type='c',
death='d',
recur_or_meta='l',
OP_site_recur='l',
meta='l',
meta_site='c',
OS='d',
DFS='d',
.default = 'c'))
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Invisible",
ifelse(Location==1, "Central", "Peripheral")),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")))
with(lungSCC, round(100 * prop.table(table(death, meta), 2), 1))
with(lungSCC, chisq.test(table(death, meta)))
with(lungSCC, table(death, meta))
with(lungSCC, fisher.test(table(death, meta)))
fit <- glm(death~Necrosis, family="binomial", data=lungSCC)
summary(fit)
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~I(LN_ratio/50), family="binomial", data=lungSCC)
summary(fit)
fit <- glm(death~I(LN_ratio/10), family="binomial", data=lungSCC)
summary(fit)
fit <- glm(death~I(LN_ratio/2), family="binomial", data=lungSCC)
summary(fit)
fit <- glm(death~I(LN_ratio/10), family="binomial", data=lungSCC)
summary(fit)
exp(13.8970)
# TO PRECISE
fit <- glm(death~I(LN_ratio/10), family="binomial", data=lungSCC)
summary(fit)
# TO PRECISE
fit <- glm(death~I(LN_ratio/4), family="binomial", data=lungSCC)
summary(fit)
exp(5.5588)
# TO PRECISE
fit <- glm(death~I(LN_ratio/4), family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, pT))
fit <- glm(death~pT, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
summary(fit)
exp(0.4321)
exp(0.9573)
exp(1.2622)
with(lungSCC, table(death, pN))
fit <- glm(death~pN, family="binomial", data=lungSCC)
summary(fit)
exp(0.2270)
exp(1.1673)
exp(1.6010)
with(lungSCC, table(death, pM))
fit <- glm(death~pM, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, FEV1_FVC))
fit <- glm(death~FEV1_FVC, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, CEA))
fit <- glm(death~CEA, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, meta))
with(lungSCC, fisher.test(table(death, meta)))
# REMOVE UNUSED LIBRARIES AT THE END
library(tidyverse)
library(survival)
library(ggplot2)
library(dplyr)
library(tidyr)
# CAREFUL: NEED TO REVIEW DATA TYPES (ESPECIALLY LOGICAL)
lungSCC_raw <- read_csv("LungCancer.csv",
col_types=cols(Index='c',
Sex='c',
Age='d',
Location='d',
Obst_pn_or_plugging='d',
CT_value_Mean='d',
CT_value_Std_Dev='d',
CT_value_P_major='d',
CT_V_ratio='d',
CT_Kernel='c',
Necrosis='c',
Underlying_lung='c',
Multiplicity='l',
Effusion='l',
Bronchoscopy='c',
Differentiation='c',
pos_LN='c',
total_LN='d',
LN_ratio='d',
cT='c',
cN='c',
cM='c',
pT='c',
pN='c',
pM='c',
Smoking_state='c',
PY='d',
Cessation_time='d',
FVCpercentPRED='d',
FEV1percentPRED='d',
FEV1_FVC='d',
CEA='d',
post_opCTx='l',
post_op_RTx='l',
op_type='c',
death='d',
recur_or_meta='l',
OP_site_recur='l',
meta='l',
meta_site='c',
OS='d',
DFS='d',
.default = 'c'))
# CAREFUL: NEED TO REVIEW DATA TYPES (ESPECIALLY LOGICAL)
lungSCC_raw <- read_csv("LungCancer.csv",
col_types=cols(Index='c',
Sex='c',
Age='d',
Location='d',
Obst_pn_or_plugging='d',
CT_value_Mean='d',
CT_value_Std_Dev='d',
CT_value_P_major='d',
CT_V_ratio='d',
CT_Kernel='c',
Necrosis='c',
Underlying_lung='c',
Multiplicity='l',
Effusion='l',
Bronchoscopy='c',
Differentiation='c',
pos_LN='c',
total_LN='d',
LN_ratio='d',
cT='c',
cN='c',
cM='c',
pT='c',
pN='c',
pM='c',
Smoking_state='c',
PY='d',
Cessation_time='d',
FVCpercentPRED='d',
FEV1percentPRED='d',
FEV1_FVC='d',
CEA='d',
post_opCTx='l',
post_op_RTx='l',
op_type='c',
death='d',
recur_or_meta='l',
OP_site_recur='l',
meta='l',
meta_site='c',
OS='d',
DFS='d',
.default = 'c'))
names(lungSCC_raw)
str(lungSCC_raw)
dim(lungSCC_raw)
head(lungSCC_raw)
summary(lungSCC_raw)
table(lungSCC_raw$Location, useNA="always")
table(lungSCC_raw$death, useNA="always")
sum(is.na(lungSCC_raw$death))
# Radiologic features
table(lungSCC_raw$Obst_pn_or_plugging, useNA="always")
table(lungSCC_raw$Necrosis, useNA="always")
table(lungSCC_raw$Underlying_lung, useNA="always")
table(lungSCC_raw$Effusion, useNA="always")
# Clinicopathologic features
table(lungSCC_raw$Sex, useNA="always")
table(lungSCC_raw$Age, useNA="always")
table(lungSCC_raw$LN_ratio, useNA="always")
table(lungSCC_raw$cT, useNA="always")
table(lungSCC_raw$cN, useNA="always")
table(lungSCC_raw$cM, useNA="always")
table(lungSCC_raw$pT, useNA="always")
table(lungSCC_raw$pN, useNA="always")
table(lungSCC_raw$pM, useNA="always")
table(lungSCC_raw$Smoking_state, useNA="always")
table(lungSCC_raw$FEV1_FVC, useNA="always")
table(lungSCC_raw$CEA, useNA="always")
table(lungSCC_raw$op_type, useNA="always")
table(lungSCC_raw$meta, useNA="always")
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")))
with(lungSCC, fisher.test(table(death, Obst_pn_or_plugging)))
with(lungSCC, fisher.test(table(death, Effusion)))
fit <- glm(death~Location, family="binomial", data=lungSCC)
summary(fit)
exp(0.2749)
fit <- glm(death~Necrosis, family="binomial", data=lungSCC)
summary(fit)
fit <- glm(death~Underlying_lung, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, meta))
with(lungSCC, fisher.test(table(death, meta)))
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
summary(fit)
# TRY TO SPLIT INTO RANGES
fit <- glm(death~I(LN_ratio/4), family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, pT))
fit <- glm(death~pT, family="binomial", data=lungSCC)
summary(fit)
exp(0.4370)
exp(0.9622)
exp(1.2672)
with(lungSCC, table(death, pN))
fit <- glm(death~pN, family="binomial", data=lungSCC)
summary(fit)
exp(0.2224)
exp(1.1628)
exp(1.5965)
with(lungSCC, table(death, pM))
fit <- glm(death~pM, family="binomial", data=lungSCC)
summary(fit)
exp(15.8626)
with(lungSCC, table(death, FEV1_FVC))
fit <- glm(death~FEV1_FVC, family="binomial", data=lungSCC)
summary(fit)
exp(0.011147)
with(lungSCC, table(death, CEA))
fit <- glm(death~CEA, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, fisher.test(table(death, Effusion)))
fit <- glm(death~Location, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
summary(fit)
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
death=ifelse(death==0, "Alive","Dead"),
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")))
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")),
pN=ifelse(pN==1, "pN0", "pN1", "pN2", "pN3"))
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")),
pN = factor(pN, levels = c("1", "2", "3", "4"), labels = c("pN0", "pN1", "pN2", "pN3")))
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
summary(fit)
with(lungSCC, table(death, pN))
fit <- glm(death~pN, family="binomial", data=lungSCC)
summary(fit)
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")),
cN = factor(cN, levels = c("1", "2", "3", "4"), labels = c("cN0", "cN1", "cN2", "cN3")),
cM = factor(cM, levels = c("1", "3"), labels = c("cM0", "cM1b")),
pN = factor(pN, levels = c("1", "2", "3", "4"), labels = c("pN0", "pN1", "pN2", "pN3")),
pM = factor(pM, levels = c("1", "3"), labels = c("pM0", "pM1b")))
with(lungSCC, table(death, pN))
fit <- glm(death~pN, family="binomial", data=lungSCC)
summary(fit)
# TO BE COMPLETED
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")),
cT = factor(cT, levels = c("1", "2", "3", "4"), labels = c("cT1", "cT2", "cT3", "cT4")),
cN = factor(cN, levels = c("1", "2", "3", "4"), labels = c("cN0", "cN1", "cN2", "cN3")),
cM = factor(cM, levels = c("1", "3"), labels = c("cM0", "cM1b")),
pT = factor(pT, levels = c("1", "2", "3", "4"), labels = c("pT1", "pT2", "pT3", "pT4")),
pN = factor(pN, levels = c("1", "2", "3", "4"), labels = c("pN0", "pN1", "pN2", "pN3")),
pM = factor(pM, levels = c("1", "3"), labels = c("pM0", "pM1b")))
fit_meta <- coxph(Surv(OS, death)~meta, data=lungSCC)
library(tidyverse)
library(survival)
library(survminer)
# Note: Check only data type of columns that we want to work with since we have set the default for the remaining as c already
lungSCC_raw <- read_csv("LungCancer.csv",
col_types=cols(Sex='c',
Age='c',
Location='d',
Obst_pn_or_plugging='d',
Necrosis='d',
Underlying_lung='d',
Effusion='d',
LN_ratio='d',
cT='c',
cN='c',
cM='c',
pT='c',
pN='c',
pM='c',
Smoking_state='c',
FEV1_FVC='d',
CEA='d',
op_type='c',
death='d',
OP_site_recur='l',
meta='l',
OS = "d",
.default = 'c'))
table(lungSCC_raw$Location, useNA="always")
table(lungSCC_raw$death, useNA="always")
# Radiologic features
table(lungSCC_raw$Obst_pn_or_plugging, useNA="always")
table(lungSCC_raw$Necrosis, useNA="always")
table(lungSCC_raw$Underlying_lung, useNA="always")
table(lungSCC_raw$Effusion, useNA="always")
# Clinicopathologic features
table(lungSCC_raw$Sex, useNA="always")
table(lungSCC_raw$Age, useNA="always")
table(lungSCC_raw$LN_ratio, useNA="always")
table(lungSCC_raw$cT, useNA="always")
table(lungSCC_raw$cN, useNA="always")
table(lungSCC_raw$cM, useNA="always")
table(lungSCC_raw$pT, useNA="always")
table(lungSCC_raw$pN, useNA="always")
table(lungSCC_raw$pM, useNA="always")
table(lungSCC_raw$Smoking_state, useNA="always")
table(lungSCC_raw$FEV1_FVC, useNA="always")
table(lungSCC_raw$CEA, useNA="always")
table(lungSCC_raw$op_type, useNA="always")
table(lungSCC_raw$meta, useNA="always")
lungSCC <- mutate(lungSCC_raw,
Location=ifelse(Location==0, "Peripheral","Central"),
Necrosis=ifelse(Necrosis==0, "NoRemark",
ifelse(Necrosis==1, "Necrosis", "Cavitization")),
Underlying_lung=ifelse(Underlying_lung==0, "NoRemark",
ifelse(Underlying_lung==1, "Emphysema", "ILA")),
Sex=factor(Sex, levels=c("F", "M")),
AG=ifelse((Age<60), "LT60", "OV60"),
AG=factor(AG),
OP=factor(op_type, labels=c("lobectomy", "pneumonectomy", "segmentectomy", "LN biopsy", "No OP")),
Smoking_state=factor(Smoking_state, labels=c("unknown", "current-smoker", "ex- smoker", "non- smoker")),
cT=factor(cT, levels=c("1", "2", "3", "4"), labels=c("cT1", "cT2", "cT3", "cT4")),
cN=factor(cN, levels=c("1", "2", "3", "4"), labels=c("cN0", "cN1", "cN2", "cN3")),
cM=factor(cM, levels=c("1", "3"), labels=c("cM0", "cM1b")),
pT=factor(pT, levels=c("1", "2", "3", "4"), labels=c("pT1", "pT2", "pT3", "pT4")),
pN=factor(pN, levels=c("1", "2", "3", "4"), labels=c("pN0", "pN1", "pN2", "pN3")),
pM=factor(pM, levels=c("1", "3"), labels=c("pM0", "pM1b")))
table(lungSCC$AG)
with(lungSCC, table(death, LN_ratio))
fit <- glm(death~LN_ratio, family="binomial", data=lungSCC)
summary(fit)
exp(confint(glm(death~LN_ratio, family="binomial", data=lungSCC))[2,])
exp(1.38)
